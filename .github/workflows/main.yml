name: 2048 AI Optimized Benchmark

on: [push, pull_request, schedule]

jobs:
  benchmark:
    runs-on: ubuntu-latest
    
    steps:
    - name: ðŸš€ Checkout code
      uses: actions/checkout@v4
      
    - name: ðŸ› ï¸ Setup environment
      run: |
        sudo apt-get update
        sudo apt-get install -y g++-11
        echo "CXX=g++-11" >> $GITHUB_ENV
        
    - name: ðŸ”¨ Compile with maximum optimizations
      run: |
        g++ -O3 -std=c++17 -pthread -march=native -flto -DNDEBUG \
            -o 2048_ai_optimized 2048_ai_optimized.cpp
        
    - name: ðŸ“Š Run performance test
      timeout-minutes: 10
      run: |
        echo "ðŸ§ª å¼€å§‹é«˜æ€§èƒ½æµ‹è¯•..."
        ./2048_ai_optimized
        
    - name: ðŸ“¦ Upload artifact with unique name
      uses: actions/upload-artifact@v4
      with:
        name: 2048-ai-results-${{ github.run_id }}-${{ github.run_attempt }}
        path: |
          2048_ai_optimized
        retention-days: 7
